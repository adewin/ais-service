package uk.gov.ukho.aisbatchlambda;

import static org.assertj.core.api.Assertions.assertThat;
import static org.assertj.core.api.Assertions.tuple;

import org.junit.Test;

public class JobsProviderTest {
  private static final Double DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION = 0.008983031;
  private static final long DISTANCE_INTERPOLATION_THRESHOLD_30KM = 30L * 1000;
  private static final long DISTANCE_INTERPOLATION_THRESHOLD_100KM = 100L * 1000;
  private static final long ONE_HOUR_IN_MILLISECONDS = 60L * 60 * 1000;
  private static final long TIME_INTERPOLATION_THRESHOLD_6HR = 6L * ONE_HOUR_IN_MILLISECONDS;
  private static final long TIME_INTERPOLATION_THRESHOLD_18HR = 18L * ONE_HOUR_IN_MILLISECONDS;

  @Test
  public void whenGetJobsThenCorrectJobsReturned() {
    assertThat(JobsProvider.getInstance().getJobs())
        .as("Jobs returned are correct")
        .extracting(
            "resolution",
            "prefix",
            "distanceInterpolationThreshold",
            "timeInterpolationThreshold",
            "startPeriod",
            "endPeriod",
            "inputLocation",
            "isOutputLocationSensitive",
            "draughtIndex",
            "active")
        .containsExactlyInAnyOrder(
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Jul-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2018-07-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Aug-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-08-01",
                "2018-08-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Sep-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-09-01",
                "2018-09-30",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Oct-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-10-01",
                "2018-10-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Nov-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-11-01",
                "2018-11-30",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Dec-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-12-01",
                "2018-12-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Jan-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-01-01",
                "2019-01-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Feb-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-02-01",
                "2019-02-28",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Mar-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-03-01",
                "2019-03-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-Apr-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-04-01",
                "2019-04-30",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "monthly-world-1k-30km-6hr-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-05-01",
                "2019-05-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "seasonal-world-1k-30km-6hr-Autumn-Aug-2018-Oct-2018",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-08-01",
                "2018-10-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "seasonal-world-1k-30km-6hr-Winter-Nov-2018-Jan-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-11-01",
                "2019-01-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "seasonal-world-1k-30km-6hr-Spring-Feb-2019-Apr-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2019-02-01",
                "2019-04-30",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                false,
                null,
                false),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-unknowndraught-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "unknown",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught1-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "0",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught2-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "1",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught3-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "2",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught1-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "3",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught2-30km-6hr-Jul-2018-May-2019" + "",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "4",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught3-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "5",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught4-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "6",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught5-30km-6hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_30KM,
                TIME_INTERPOLATION_THRESHOLD_6HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "7",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-unknowndraught-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "unknown",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught1-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "0",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught2-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "1",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat1draught3-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "2",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught1-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "3",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught2-100km-18hr-Jul-2018-May-2019" + "",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "4",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught3-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "5",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught4-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "6",
                true),
            tuple(
                DEGREES_AT_EQUATOR_FOR_1KM_RESOLUTION,
                "annual-world-1k-cat2draught5-100km-18hr-Jul-2018-May-2019",
                DISTANCE_INTERPOLATION_THRESHOLD_100KM,
                TIME_INTERPOLATION_THRESHOLD_18HR,
                "2018-07-01",
                "2019-05-31",
                "/",
                true,
                "7",
                true));
  }
}
